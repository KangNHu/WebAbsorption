package com.liveeasy.web.absorption.core.plugin;import com.liveeasy.web.absorption.core.factory.Product;import us.codecraft.webmagic.*;import us.codecraft.webmagic.downloader.HttpClientDownloader;/** * 中央下载器 */public class CentralDownloaderPlugin extends HttpClientDownloader implements Product{    private static UserAgent userAgent = UserAgent.newInstance();    private DownloaderPlugin downloaderPlugin;    public CentralDownloaderPlugin(){        super();    }    public CentralDownloaderPlugin setDownloaderPlugin(DownloaderPlugin downloaderPlugin){        this.downloaderPlugin = downloaderPlugin;        return this;    }    @Override    public Page download(Request request, Task task) {        downloaderPlugin.setTask(task);        if(null != downloaderPlugin){                downloaderPlugin.downloadPreposition(task.getSite() , userAgent.getAgents());        }        Page page = super.download(request, task);        return page;    }    @Override    protected void onError(Request request) {        if(null != downloaderPlugin){            downloaderPlugin.downloadError(request);        }        super.onError(request);    }    @Override    public Product createClone() throws CloneNotSupportedException {        return (Product) super.clone();    }}