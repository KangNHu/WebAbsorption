package com.liveeasy.web.absorption.core.schehule;import com.liveeasy.web.absorption.core.pipeline.DataStreamPipeline;import com.liveeasy.web.absorption.core.pipeline.WebAbsorptionPipeline;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import java.io.*;import java.net.URL;import java.util.List;public abstract class AbstractDataStreamSchedule extends AbstractDataSchedule<String>{    private Logger logger = LoggerFactory.getLogger(AbstractDataStreamSchedule.class);    protected DataStreamPipeline dataStreamPipeline;    public AbstractDataStreamSchedule(){        super();    }    @Override    public void setDataStreamPipeline(DataStreamPipeline dataStreamPipeline){        this.dataStreamPipeline = dataStreamPipeline;    }    @Override    public DataStreamPipeline getDataStreamPipeline() {        return dataStreamPipeline;    }    @Override    protected void execute() {        String dataStreamUrl = getDataStreamUrl();        if(null != dataStreamUrl) {            try {                URL url = new URL(dataStreamUrl);                DataInputStream dataInputStream = new DataInputStream(url.openStream());                ByteData byteData = new ByteData();                byteData.setDataInputStream(dataInputStream);                byteData.setUrl(url);                dataStreamPipeline.streamPipeline(byteData);            } catch (Exception e) {                logger.error("下载图片{}失败", dataStreamUrl, e);                downloaderPlugin.picDownloaderError(dataStreamUrl, this);            }        }    }    @Override    public void setWebAbsorptionPipelines(List<WebAbsorptionPipeline> webAbsorptionPipelines) {    }    @Override    public void addElements(List<String> urls) {        if(null != urls){            for (int i =0 , length = urls.size() ; i < length ; i++) {                addElement(urls.get(i));            }        }    }    @Override    public List<WebAbsorptionPipeline> getWebAbsorptionPipelines() {        return null;    }    protected abstract String getDataStreamUrl();}