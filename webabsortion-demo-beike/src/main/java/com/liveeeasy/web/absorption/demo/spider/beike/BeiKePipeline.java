package com.liveeeasy.web.absorption.demo.spider.beike;import com.alibaba.fastjson.JSON;import com.liveeasy.web.absorption.core.annotation.SPI;import com.liveeasy.web.absorption.core.pipeline.SimpleWebAbsorptionPipeline;import com.liveeeasy.web.absorption.demo.spider.beike.service.IBeiKeEstateService;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.data.redis.core.RedisTemplate;import us.codecraft.webmagic.ResultItems;import us.codecraft.webmagic.Task;import java.util.List;@SPI("beiKeSpider")public class BeiKePipeline extends SimpleWebAbsorptionPipeline {    private static Logger logger = LoggerFactory.getLogger(BeiKePipeline.class);    private RedisTemplate<String , String> redisTemplate;    private static final String ESTATE_INFO_LIST = "estate_info_list";    private IBeiKeEstateService estateService;    public void setEstateService(IBeiKeEstateService estateService){        this.estateService = estateService;    }    public void setRedisTemplate(RedisTemplate redisTemplate){        this.redisTemplate = redisTemplate;    }    @Override    public void lastPipeline(ResultItems resultItem, Task task) {        redisTemplate.opsForList().leftPush(ESTATE_INFO_LIST , JSON.toJSONString(resultItem.getAll()));    }    @Override    public void pipeline(List<ResultItems> resultItems, Task task) {           // estateService.batchInsert(resultItems.stream().map(item -> item.getAll()).collect(Collectors.toList()));    }}