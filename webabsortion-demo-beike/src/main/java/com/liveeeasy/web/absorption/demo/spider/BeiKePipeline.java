package com.liveeeasy.web.absorption.demo.spider;import com.alibaba.fastjson.JSON;import com.liveeasy.web.absorption.core.annotation.SPI;import com.liveeasy.web.absorption.core.pipeline.AbstractWebAbsorptionPipeline;import com.liveeeasy.web.absorption.demo.spider.service.IEstateService;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.data.redis.core.RedisTemplate;import us.codecraft.webmagic.ResultItems;import us.codecraft.webmagic.Task;import java.util.ArrayList;import java.util.List;import java.util.Map;import java.util.concurrent.BlockingQueue;import java.util.concurrent.LinkedBlockingQueue;@SPI("beiKeSpider")public class BeiKePipeline extends AbstractWebAbsorptionPipeline{    private static Logger logger = LoggerFactory.getLogger(BeiKePipeline.class);    private RedisTemplate<String , String> redisTemplate;    private static final String ESTATE_INFO_LIST = "estate_info_list";    private IEstateService estateService;    public void setEstateService(IEstateService estateService){        this.estateService = estateService;    }    public void setRedisTemplate(RedisTemplate redisTemplate){        this.redisTemplate = redisTemplate;    }    @Override    public void pipeline(ResultItems resultItems, Task task) {        redisTemplate.opsForList().leftPush(ESTATE_INFO_LIST , JSON.toJSONString(resultItems.getAll()));    }}